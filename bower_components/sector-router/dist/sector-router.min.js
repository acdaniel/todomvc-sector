/** sector-router v0.3.1 | (c) 2014 Adam Daniel <adam@acdaniel.com> | MIT license */
!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self);var o=t;o=o.sector||(o.sector={}),o=o.ext||(o.ext={}),o.router=e()}}(function(){return function e(t,o,n){function r(a,u){if(!o[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=o[a]={exports:{}};t[a][0].call(c.exports,function(e){var o=t[a][1][e];return r(o?o:e)},c,c.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t){var o;try{o=e("sector")}catch(n){o=window.sector}var r=e("path-to-regexp"),i=e("lodash-node/modern/arrays/zipObject");t.exports=o.Component.define({type:"router",defaults:{navigateRequestTopic:"ui.navigateRequested",protectRouteRequestTopic:"ui.protectRouteRequested",reloadRouteRequestTopic:"ui.reloadRouteRequested",uiReadyTopic:"ui.ready",routeChangedTopic:"ui.routeChanged",confirmRouteChangeRequestTopic:"ui.confirmRouteChangeRequested",routeChangeConfirmedTopic:"ui.routeChangeConfirmed"},initialize:function(e){if(this.routes=[],this.protectedRouteFragment=null,e.routes)for(var t in e.routes)this.addRoute(t,e.routes[t]);this.subscribe(this.navigateRequestTopic,this.handleNavigateRequest),this.subscribe(this.protectRouteRequestTopic,this.handleProtectRouteRequest),this.subscribe(this.routeChangeConfirmedTopic,this.handleRouteChangeConfirmed),this.subscribe(this.reloadRouteRequestTopic,this.handleReloadRequest),this.listenTo(window,"hashchange",this.handleHashChange),this.subscribe(this.uiReadyTopic,function(){this.handleHashChange()})},addRoute:function(e,t){this.trace("adding named route: "+t,e);var o=[],n=r(e,o);this.routes.push({topic:t,re:n,keys:o})},getFragment:function(){return this.parseFragment(window.location.href)},parseFragment:function(e){var t,o="";return t=e.match(/#(.*)$/),o=t?t[1]:""},lookupRoute:function(e){e=e||"/",this.trace("parsing fragment "+e);for(var t=function(e){return e.name},o=0,n=this.routes.length;n>o;o++){var r=this.routes[o];this.trace("eval route",r);var a=r.re.test(e);if(a){var u=r.re.exec(e);this.trace("route selected",u);var s=r.keys.map(t);return{topic:r.topic,data:i(s,u.slice(1))}}}},handleHashChange:function(){var e,t;e=this.getFragment(),this.protectedRouteFragment&&e!==this.protectedRouteFragment?this.publish(this.confirmRouteChangeRequestTopic,{currentRoute:this.protectedRouteFragment,attemptedRoute:e}):(this.publish(this.routeChangedTopic,{path:e||"/"}),t=this.lookupRoute(e),t&&this.publish(t.topic,t.data))},handleNavigateRequest:function(e){var t=e.data?e.data:"/";e.ignoreProtected&&(this.protectedRouteFragment=null),window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+t},handleReloadRequest:function(e){var t=e.data?e.data:this.getFragment();this.stopListening(window,"hashchange"),window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+t,window.location.reload()},handleProtectRouteRequest:function(e){var t=e.data!==!1?!0:!1;this.protectedRouteFragment=t?this.getFragment():null},handleRouteChangeConfirmed:function(e){this.protectedRouteFragment=null,window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+e.data.route,this.handleHashChange()}})},{"lodash-node/modern/arrays/zipObject":3,"path-to-regexp":6}],2:[function(e,t,o){o.mixins={},o.components={Router:e("./components/router")}},{"./components/router":1}],3:[function(e,t){function o(e,t){var o=-1,r=e?e.length:0,i={};for(t||!r||n(e[0])||(t=[]);++o<r;){var a=e[o];t?i[a]=t[o]:a&&(i[a[0]]=a[1])}return i}var n=e("../objects/isArray");t.exports=o},{"../objects/isArray":5}],4:[function(e,t){function o(e){return"function"==typeof e&&i.test(e)}var n=Object.prototype,r=n.toString,i=RegExp("^"+String(r).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");t.exports=o},{}],5:[function(e,t){var o=e("../internals/isNative"),n="[object Array]",r=Object.prototype,i=r.toString,a=o(a=Array.isArray)&&a,u=a||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&i.call(e)==n||!1};t.exports=u},{"../internals/isNative":4}],6:[function(e,t){function o(e,t,o){o=o||{};var n=o.sensitive,r=o.strict,i=o.end!==!1;return t=t||[],e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(r?"":"/?").replace(/\/\(/g,"/(?:").replace(/([\/\.])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(e,o,n,r,i,a,u){return o=o||"",n=n||"",i=i||"([^/"+n+"]+?)",u=u||"",t.push({name:r,optional:!!u}),""+(u?"":o)+"(?:"+n+(u?o:"")+i+(a?"((?:[\\/"+n+"].+?)?)":"")+")"+u}).replace(/\*/g,"(.*)"),new RegExp("^"+e+(i?"$":"(?=/|$)"),n?"":"i"))}t.exports=o},{}]},{},[2])(2)});
