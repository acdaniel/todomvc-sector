/** sector-router v0.1.3 | (c) 2014 Adam Daniel <adam@acdaniel.com> | MIT license */
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self);var i=e;i=i.sector||(i.sector={}),i=i.ext||(i.ext={}),i.router=t()}}(function(){return function t(e,i,o){function n(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return n(i?i:t)},c,c.exports,t,e,i,o)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({1:[function(t,e){var i;try{i=t("sector")}catch(o){i=window.sector}var n=t("../mixins/route-content");e.exports=i.Component.define({type:"route-content"},i.mixins.View,n)},{"../mixins/route-content":5}],2:[function(t,e){var i;try{i=t("sector")}catch(o){i=window.sector}var n=t("../mixins/route-nav");e.exports=i.Component.define({type:"route-content"},i.mixins.View,n)},{"../mixins/route-nav":6}],3:[function(t,e){var i;try{i=t("sector")}catch(o){i=window.sector}var n=/\((.*?)\)/g,r=/(\(\?)?:\w+/g,s=/\*\w+/g,a=/[\-{}\[\]+?.,\\\^$|#\s]/g;e.exports=i.Component.define({type:"router",defaults:{mode:"hash",root:"/",routeTopic:"ui.routeChanged",backRequestTopic:"ui.navigateBackRequested",forwardRequestTopic:"ui.navigateForwardRequested",navigateRequestTopic:"ui.navigateRequested",uiReadyTopic:"ui.ready"},initialize:function(t){if(history.pushState||(this.mode="hash"),"/"!==this.root&&(this.root="/"+this.clearSlashes(t.root)+"/"),this.routes={},t.routes)for(var e in t.routes)this.addRoute(e,t.routes[e]);this.subscribe(this.navigateRequestTopic,this.handleNavigateRequest),this.subscribe(this.backRequestTopic,this.handleBackRequest),this.subscribe(this.forwardRequestTopic,this.handleForwardRequest),this.listenTo(window,"hashchange",this.handleHashChange),this.subscribe(this.uiReadyTopic,function(){var t=this.parseFragment(this.getFragment());this.publish(this.routeTopic,t)})},addRoute:function(t,e){e=e.replace(a,"\\$&").replace(n,"(?:$1)?").replace(r,function(t,e){return e?t:"([^/?]+)"}).replace(s,"([^?]*?)");var i=new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$");this.trace("adding named route: "+t,i),this.routes[t]=i},getFragment:function(){var t,e="";return"history"===this.mode?(e=this.clearSlashes(decodeURI(location.pathname+location.search)),e=e.replace(/\?(.*)$/,""),e="/"!==this.root?e.replace(this.root,""):e):(t=window.location.href.match(/#(.*)$/),e=t?t[1]:""),e},parseFragment:function(t){t=t||"/",this.trace("parsing fragment "+t);for(var e in this.routes){var o=this.routes[e];this.trace("eval route "+e,o);var n=o.exec(t);if(n)return n=n.slice(1),{name:e,path:t,params:i.map(n,function(t,e){return e===n.length-1?t||null:t?decodeURIComponent(t):null})}}return{}},clearSlashes:function(t){return t.toString().replace(/\/$/,"").replace(/^\//,"")},handleHashChange:function(){var t,e;t=this.getFragment(),e=this.parseFragment(t),this.publish(this.routeTopic,e)},handleNavigateRequest:function(t){var e=t.data?t.data:"";"history"===this.mode?history.pushState(null,null,this.root+this.clearSlashes(e)):(window.location.href.match(/#(.*)$/),window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+e);var i=this.parseFragment(e);this.publish(this.routeTopic,i)},handleBackRequest:function(){var t,e;window.history.back(),t=this.getFragment(),e=this.parseFragment(t),this.publish(this.routeTopic,e)},handleForwardRequest:function(){var t,e;window.history.forward(),t=this.getFragment(),e=this.parseFragment(t),this.publish(this.routeTopic,e)}})},{}],4:[function(t,e,i){i.mixins={RouteContent:t("./mixins/route-content"),RouteNav:t("./mixins/route-nav")},i.components={Router:t("./components/router"),RouteContent:t("./components/route-content"),RouterNav:t("./components/route-nav")}},{"./components/route-content":1,"./components/route-nav":2,"./components/router":3,"./mixins/route-content":5,"./mixins/route-nav":6}],5:[function(t,e){var i;try{i=t("sector")}catch(o){i=window.sector}e.exports=function(){this.defaults=i.defaults({},this.defaults,{route:null,activeClassName:"active",routeChangedTopic:"ui.routeChanged"}),this.after("initialize",function(){this.subscribe(this.routeChangedTopic,function(t){this.route===t.data.path?i.addClassName(this.el,this.activeClassName):i.removeClassName(this.el,this.activeClassName)})})}},{}],6:[function(t,e){var i;try{i=t("sector")}catch(o){i=window.sector}e.exports=function(){this.defaults=i.defaults({},this.defaults,{activeClassName:"active",linkSelector:"a[href]",routeChangedTopic:"ui.routeChanged"}),this.after("initialize",function(){this.subscribe(this.routeChangedTopic,function(t){for(var e,o=[].slice.call(this.select(this.linkSelector)),n=0,r=o.length;r>n;n++)e=o[n],e.getAttribute("href").toString()==="#"+t.data.path?i.addClassName(e,this.activeClassName):i.removeClassName(e,this.activeClassName)})})}},{}]},{},[4])(4)});